<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="mrp_production_employee_cost_line_tree" model="ir.ui.view">
        <field name="name">mrp.production.employee.cost.line.tree</field>
        <field name="model">mrp.production.employee.cost.line</field>
        <field name="arch" type="xml">
            <list string="Breakdown" default_order="cost desc" create="0" delete="0">
                <field name="employee_id"/>
                <field name="duration_hours" widget="float_time" sum="Total Hours"/>
                <field name="hourly_rate" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                <field name="cost" widget="monetary" options="{'currency_field': 'currency_id'}" sum="Total Cost" decoration-bf="1"/>
                <field name="currency_id" column_invisible="1"/>
            </list>
        </field>
    </record>

    <record id="mrp_production_form_inherit_employee_cost" model="ir.ui.view">
        <field name="name">mrp.production.form.inherit.employee.cost</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='miscellaneous']" position="before">
                <page string="Labor Cost (Real)" name="employee_cost_tab">
                    <group>
                        <group>
                            <field name="employee_cost_total" widget="monetary" options="{'currency_field': 'currency_id'}" decoration-bf="1"/>
                        </group>
                    </group>
                    <field name="employee_cost_line_ids"
                           options="{'no_create': True, 'no_open': True}"
                           context="{'tree_view_ref': 'mrp_parallel_console.mrp_production_employee_cost_line_tree'}"/>
                </page>
            </xpath>
        </field>
    </record>

    <template id="mrp_cost_structure_inherit_labor" inherit_id="mrp_account_enterprise.mrp_cost_structure">
        <xpath expr="//t[@name='operations']" position="after">
            <t t-if="line.get('labors')">
                <div name="labors" class="mt-4">
                    <h3 class="o_mrp_header">Labor Cost (Real Union)</h3>
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th class="text-end">Hours</th>
                                <th class="text-end">Rate/Hour</th>
                                <th class="text-end">Total Cost</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="line['labors']" t-as="labor">
                                <td><span t-esc="labor['name']"/></td>
                                <td class="text-end">
                                    <span t-esc="labor['time']" t-options="{'widget': 'float', 'precision': 4}"/>
                                </td>
                                <td class="text-end">
                                    <span t-esc="labor['cost_hourly']" t-options="{'widget': 'monetary', 'display_currency': currency}"/>
                                </td>
                                <td class="text-end fw-bold">
                                    <span t-esc="labor['total_cost']" t-options="{'widget': 'monetary', 'display_currency': currency}"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
